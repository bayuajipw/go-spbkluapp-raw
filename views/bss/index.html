<!DOCTYPE html>
<html lang="en">
{{template "Header"}}

<body class="dashboard dashboard_1">
   <div class="full_container">
      <div class="inner_container">
         <!-- Sidebar  -->
         {{template "Sidebar" .}}
         <!-- end sidebar -->
         <!-- right content -->
         <div id="content">
            <!-- topbar -->
            {{template "Navbar" .}}

            <!-- end topbar -->
            <!-- dashboard inner -->
            <div class="midde_cont">
               <div class="container-fluid">
                  <div class="row column_title">
                     <div class="col-md-12">
                        <div class="page_title">
                           <h2>Daftar BSS</h2>
                        </div>
                     </div>
                  </div>
                  <div class="row">
                     <!-- table section -->
                     <div class="col-md-12">
                        <div class="white_shd full margin_bottom_30">
                           <div class="full graph_head">
                              <div class="heading1 margin_0">
                                 <!-- <h2>Hover Table</h2> -->
                                 {{if or (eq .role 0) (eq .role 1)}}
                                 <button class="btn btn-sm btn-success" data-toggle="modal" data-target="#addBssModal"
                                    style="font-size:0.8rem;">Add BSS</button>
                                 {{end}}
                                 <button id="reload-button" class="btn btn-sm btn-primary"
                                    style="font-size:0.8rem;">Reload Table</button>
                              </div>
                           </div>

                           <div class="padding_infor_info">
                              <div class="table-responsive-sm">
                                 <table id="data-table" class="table table-hover" style="font-size:0.75rem;"
                                    width="100%" cellspacing="0">
                                    <thead style="font-size:0.7rem;">
                                       <tr>
                                          <th>No</th>
                                          <th style="padding-left: 20px; padding-right: 50px;">Action</th>
                                          <th>Nama</th>
                                          <th>Alamat</th>
                                          <th>Longitude</th>
                                          <th>Latitude</th>
                                          <th>Slot</th>
                                          <th>Status</th>
                                          <th>Last Ping</th>
                                          <!-- <th>Created At</th>
                                          <th>Updated At</th> -->
                                          <th>User Active</th>
                                          <th>QR Code</th>
                                          <th>Transaction ID</th>
                                       </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                 </table>

                              </div>
                           </div>
                        </div>
                     </div>


                     <div class="col-md-12">
                        <div id="lockerTable" class="white_shd full margin_bottom_30" style="display: none;">
                           <!-- Edit Modal -->
                           <div class="full graph_head">
                              <div class="heading1 margin_0" style="display: flex; align-items: center;">
                                 <h2 id="locker-title" style="margin-right: 10px;"></h2>
                                 {{if or (eq .role 0) (eq .role 1)}}
                                 <button class="btn btn-sm btn-success" id="addlocker-button"
                                    style="font-size:0.8rem;">Add Locker</button>
                                 {{end}}
                                 <button id="reloadlocker-button" class="btn btn-sm btn-primary ml-1"
                                    style="font-size: 0.8rem;">Reload Table</button>
                              </div>

                           </div>
                           <div class="padding_infor_info">
                              <div class="table-responsive-sm">
                                 <table id="locker-table" class="table table-hover" style="font-size:0.75rem;"
                                    width="100%" cellspacing="0">
                                    <thead style="font-size:0.7rem;">
                                       <tr>
                                          <th>No</th>
                                          <th style="padding-left: 20px; padding-right: 50px;">Action</th>
                                          <th>Locker Id</th>
                                          <!-- <th>Bss Name</th> -->
                                          <th>Locker Name</th>
                                          <th>Locker Number</th>
                                          <th>Status</th>
                                          <th>Swapping Out</th>
                                          <th>SoC</th>
                                          <th>SoH</th>
                                          <th>Temp</th>
                                          <th>Stay Hour</th>
                                          <th>Created At</th>
                                          <th>Updated At</th>
                                       </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                 </table>

                              </div>
                           </div>
                        </div>
                     </div>


                     <!-- Auto hide div edit form -->

                     <div class="col-md-12">
                        <div class="white_shd full margin_bottom_30">
                           <!-- Edit Modal -->
                           <div id="editForm" style="padding:30px ;display: none;">
                              <form id="editDataForm" style="font-size: 0.8rem; ">
                                 <div class="row">
                                    <div class="col-md-4">
                                       <!-- Form fields for adding data -->
                                       <div class="form-group">
                                          <label for="edit-rowId">Id BSS:</label>
                                          <input type="text" class="form-control" id="edit-rowId" name="edit-rowId"
                                             style="font-size:0.8rem" readonly>
                                       </div>
                                       <div class="form-group">
                                          <label for="edit-name">Name:</label>
                                          <!-- <input type="text" class="form-control" id="edit-name" name="edit-name"
                                             style="font-size:0.8rem" required> -->
                                          <input type="text" class="form-control" id="edit-name" name="edit-name"
                                             style="font-size: 0.8rem" pattern="[a-zA-Z0-9-_]+"
                                             title="Input should contain only alphanumeric characters, hyphen (-), or underscore (_)."
                                             required oninput="validateInput(this)">
                                       </div>
                                       <div class="form-group">
                                          <label for="edit-address">Address:</label>
                                          <input type="text" class="form-control" id="edit-address" name="edit-address"
                                             style="font-size:0.8rem" required>
                                       </div>
                                       <div class="form-group">
                                          <label for="edit-city">City:</label>
                                          <input type="text" class="form-control" id="edit-city" name="edit-city"
                                             style="font-size:0.8rem" required>
                                       </div>
                                       <div class="form-group">
                                          <label for="edit-province">Province:</label>
                                          <input type="text" class="form-control" id="edit-province"
                                             name="edit-province" style="font-size:0.8rem" required>
                                       </div>
                                    </div>
                                    <div class="col-md-4">
                                       <!-- Form fields for adding data -->
                                       <div class="form-group">
                                          <label for="edit-longitude">Longitude:</label>
                                          <input type="number" step="any" class="form-control" id="edit-longitude"
                                             name="edit-longitude" style="font-size:0.8rem" required>
                                       </div>
                                       <div class="form-group">
                                          <label for="edit-latitude">Latitude:</label>
                                          <input type="number" step="any" class="form-control" id="edit-latitude"
                                             name="edit-latitude" style="font-size:0.8rem" required>
                                       </div>
                                       <div class="form-group">
                                          <label for="edit-status">Status:</label>
                                          <input type="number" class="form-control" id="edit-status" name="edit-status"
                                             style="font-size:0.8rem" min=0 max=20 required>
                                       </div>
                                       <div class="form-group">
                                          <label for="edit-slot">Locker Slot:</label>
                                          <input type="text" class="form-control" id="edit-slot" name="edit-slot"
                                             style="font-size:0.8rem" disabled>
                                       </div>
                                       <div class="form-group">
                                          <label for="edit-lastping">Last Ping:</label>
                                          <input type="text" class="form-control" id="edit-lastping"
                                             name="edit-lastping" style="font-size:0.8rem" disabled>
                                       </div>
                                    </div>
                                    <div class="col-md-4">
                                       <!-- Form fields for adding data -->
                                       <div class="form-group">
                                          <label for="edit-useractive">User Active:</label>
                                          <input type="text" class="form-control" id="edit-useractive"
                                             name="edit-useractive" style="font-size:0.8rem" disabled>
                                       </div>
                                       <div class="form-group">
                                          <label for="edit-qrcode">QR Code:</label>
                                          <input type="text" class="form-control" id="edit-qrcode" name="edit-qrcode"
                                             style="font-size:0.8rem" disabled>
                                       </div>
                                       <div class="form-group">
                                          <label for="edit-transactionid">Transaction ID:</label>
                                          <input type="text" class="form-control" id="edit-transactionid"
                                             name="edit-transactionid" style="font-size:0.8rem" disabled>
                                       </div>
                                       <div class="form-group">
                                          <label for="edit-created">Created At:</label>
                                          <input type="text" class="form-control" id="edit-created" name="edit-created"
                                             style="font-size:0.8rem" disabled>
                                       </div>
                                       <div class="form-group">
                                          <label for="edit-updated">Updated At:</label>
                                          <input type="text" class="form-control" id="edit-updated" name="edit-updated"
                                             style="font-size:0.8rem" disabled>
                                       </div>
                                    </div>

                                 </div>
                                 <!-- Add more fields as needed -->
                                 <div>
                                    <button type="submit" class="btn btn-sm btn-primary" style="font-size:0.8rem">Update
                                       Data</button>
                                 </div>
                              </form>

                           </div>
                        </div>
                     </div>
                     <!-- table section -->
                  </div>

               </div>
               <!-- footer -->
               {{template "Footer"}}
            </div>

            <!-- Add BSS Modal -->
            <div class="modal fade" id="addBssModal" tabindex="-1" role="dialog" aria-labelledby="addBssModalLabel"
               aria-hidden="true">
               <div class="modal-dialog" role="document">
                  <div class="modal-content">
                     <div class="modal-header dash_head">
                        <h5 class="modal-title" id="addBssModalLabel" style="color: #fff;">Add Data BSS</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                           <span aria-hidden="true" style="color: #fff;">&times;</span>
                        </button>
                     </div>
                     <div class="modal-body">
                        <form id="addDataForm" style="font-size: 0.8rem;">
                           <!-- Form fields for adding data -->
                           <div class="row form-group">
                              <div class="col-md-4"><label for="add-name">Name:</label></div>
                              <div class="col-md-8">
                                 <!-- <input type="text" class="form-control" id="add-name" name="add-name"
                                    style="font-size:0.8rem" required> -->
                                 <input type="text" class="form-control" id="add-name" name="add-name"
                                    style="font-size: 0.8rem" pattern="[a-zA-Z0-9-_]+"
                                    title="Input should contain only alphanumeric characters, hyphen (-), or underscore (_)."
                                    required oninput="validateInput(this)">
                              </div>
                           </div>
                           <div class="row form-group">
                              <div class="col-md-4"><label for="add-address">Address:</label></div>
                              <div class="col-md-8"><input type="text" class="form-control" id="add-address"
                                    name="add-address" style="font-size:0.8rem" required></div>
                           </div>
                           <div class="row form-group">
                              <div class="col-md-4"><label for="add-city">City:</label></div>
                              <div class="col-md-8"><input type="text" class="form-control" id="add-city"
                                    name="add-city" style="font-size:0.8rem" required></div>
                           </div>
                           <div class="row form-group">
                              <div class="col-md-4"><label for="add-province">Province:</label></div>
                              <div class="col-md-8"><input type="text" class="form-control" id="add-province"
                                    name="add-province" style="font-size:0.8rem" required></div>
                           </div>
                           <div class="row form-group">
                              <div class="col-md-4"><label for="add-longitude">Longitude:</label></div>
                              <div class="col-md-8"><input type="number" class="form-control" id="add-longitude"
                                    name="add-longitude" step="any" style="font-size:0.8rem" required></div>
                           </div>
                           <div class="row form-group">
                              <div class="col-md-4"><label for="add-latitude">Latitude:</label></div>
                              <div class="col-md-8"><input type="number" class="form-control" id="add-latitude"
                                    name="add-latitude" step="any" style="font-size:0.8rem" required></div>
                           </div>
                           <div class="row form-group">
                              <div class="col-md-4"><label for="add-slot">Slot:</label></div>
                              <div class="col-md-8"><input type="number" class="form-control" id="add-slot"
                                    name="add-slot" style="font-size:0.8rem" min=0 max=20 required></div>
                           </div>
                           <!-- Add more fields as needed -->
                           <div class="modal-footer">
                              <button type="submit" class="btn btn-sm btn-primary" style="font-size: 0.8rem;">Submit
                                 Data</button>
                              <button type="button" class="btn btn-sm btn-danger" class="close" data-dismiss="modal"
                                 style="font-size: 0.8rem;">Cancel</button>
                           </div>
                        </form>
                     </div>
                  </div>
               </div>
            </div>

            <!-- end dashboard inner -->
         </div>
      </div>
   </div>

   {{template "Footerjs"}}

   <script>
      function validateInput(inputElement) {
         var inputValue = inputElement.value;
         var pattern = /^[a-zA-Z0-9-_]+$/;

         if (!pattern.test(inputValue)) {
            inputElement.setCustomValidity('Input should contain only alphanumeric characters, hyphen (-), or underscore (_).');
         } else {
            errorMessageElement.textContent = '';
            inputElement.setCustomValidity('');
         }
      }
   </script>

   <script>
      // datatable
      var dataTable;
      $(document).ready(function () {
         dataTable = $('#data-table').DataTable({
            paging: true, // Enable pagination
            searching: true, // Enable searching
            processing: true, // Show a loading indicator
            ajax: {
               url: '/bss_ajax', // Replace with your server endpoint
               type: 'GET', // Use POST or GET as appropriate
               dataSrc: function (response) {
                  var role = response.role
                  if (response.data === null) {
                     return [];
                  } else {
                     return response.data;
                  }
               },
            },
            columns: [ // Define your table columns here
               { data: 'No' },
               {
                  // Define the column for the "Delete" button
                  data: null,
                  render: function (data, type, row) {
                     var buttonHTML = '';

                     // Check the "role" value
                     if (dataTable.ajax.json().role === 0 || dataTable.ajax.json().role === 1) {
                        buttonHTML += '<button type="button" class="btn btn-sm btn-info edit-button" data-id="' + row.Id + '" data-name="' + row.Name + '" data-address="' + row.Address + '" data-city="' + row.City + '" data-province="' + row.Province + '"  data-longitude="' + row.Longitude + '"  data-latitude="' + row.Latitude + '"  data-slot="' + row.Slot + '"   data-status="' + row.Status + '"  data-lastping="' + row.LastPing + '"  data-created="' + row.CreatedAt + '"  data-updated="' + row.UpdatedAt + '"  data-useractive="' + row.Email + '" data-transactionid="' + row.TransactionId + '" data-qrcode="' + row.QrCode + '" style="font-size:0.75rem; margin-right:1px; margin-bottom:1px"><i class="fa fa-pencil"></i> Edit</button><button type="button" class="btn btn-sm btn-warning locker-button" data-id="' + row.Id + '" data-name="' + row.Name + '" style="font-size:0.75rem; margin-right:1px; margin-bottom:1px; color:white"><i class="fa fa-table"></i> Show Locker</button><button type="button" class="btn btn-sm btn-danger delete-button" data-id="' + row.Id + '" data-name="' + row.Name + '" style="font-size:0.75rem; margin-bottom:1px"><i class="fa fa-trash"></i> Delete</button>';
                     } else {
                        buttonHTML += 'No Action'
                     }
                     return buttonHTML;
                  }
               },
               { data: 'Name' },
               {
                  data: null, // Use null to indicate custom rendering
                  render: function (data, type, row) {
                     // Combine Address, City, and Province into a single column
                     return row.Address + ', ' + row.City + ', ' + row.Province;
                  }
               },
               { data: 'Longitude' },
               { data: 'Latitude' },
               { data: 'Slot' },
               { data: 'Status' },
               { data: 'LastPing' },
               //{ data: 'CreatedAt' },
               //{ data: 'UpdatedAt' },
               { data: 'Email' },
               { data: 'QrCode' },
               { data: 'TransactionId' }
            ],
            dom: 'lBfrtip', // Include the Buttons extension
            buttons: [
               {
                  extend: 'csv', // Excel button
                  text: 'Export to CSV', // Set custom text
               }
            ],
         });

         $('#reload-button').on('click', function () {
            dataTable.ajax.reload();
         });

         // Handle the "Delete" button click in the DataTable
         $('#data-table').on('click', '.delete-button', function () {
            selectedBssDeleteId = $(this).data('id'); // Store the row's ID
            selectedBssDeleteName = $(this).data('name'); // Store the row's Name
            Swal.fire({
               title: 'Delete Record?',
               text: 'Are you sure you want to delete ' + selectedBssDeleteName + '?',
               icon: 'warning',
               showCancelButton: true,
               confirmButtonColor: '#ff4748',
               cancelButtonColor: '#36a9e2',
               confirmButtonText: 'Yes, delete it!',
               cancelButtonText: 'Cancel'
            }).then((result) => {
               if (result.isConfirmed) {
                  // Send an AJAX request to delete the record
                  $.ajax({
                     url: '/bss_delete', // Replace with the URL for your server-side delete endpoint
                     type: 'POST',
                     data: { id: selectedBssDeleteId },
                     success: function (response) {
                        if (response.success) {
                           // Reload the DataTable to reflect the deleted record
                           dataTable.ajax.reload();
                           $('#editForm').hide();
                           $('#lockerTable').hide();
                           Toastify({
                              text: "Data " + selectedBssDeleteName + " deleted successfully",
                              duration: 3000, // Duration in milliseconds
                              close: true, // Show close button
                              style: {
                                 background: "linear-gradient(to right, #7ce1b7, #1ed085)",
                              },
                           }).showToast();
                        } else {
                           Toastify({
                              text: response.message,
                              duration: 3000, // Duration in milliseconds
                              close: true, // Show close button
                              style: {
                                 background: "linear-gradient(to right, #d49090, #ff4748)",
                              },
                           }).showToast();
                        }
                     },
                     error: function () {
                        Toastify({
                           text: "Error: An error occurred while deleting the record.",
                           duration: 3000, // Duration in milliseconds
                           close: true, // Show close button
                           style: {
                              background: "linear-gradient(to right, #d49090, #ff4748)",
                           },
                        }).showToast();
                     }
                  });

               }
            });
         });

         $('#data-table').on('click', '.edit-button', function () {
            selectedRowBssId = $(this).data('id'); // Store the row's ID
            selectedRowBssName = $(this).data('name'); // Store the row's Name
            selectedRowAddress = $(this).data('address');
            selectedRowCity = $(this).data('city');
            selectedRowProvince = $(this).data('province');
            selectedRowLongitude = $(this).data('longitude');
            selectedRowLatitude = $(this).data('latitude');
            selectedRowSlot = $(this).data('slot');
            selectedRowStatus = $(this).data('status');
            selectedRowLastping = $(this).data('lastping');
            selectedRowCreated = $(this).data('created');
            selectedRowUpdated = $(this).data('updated');
            selectedRowUserActive = $(this).data('useractive');
            selectedRowTransactionId = $(this).data('transactionid');
            selectedRowQrCode = $(this).data('qrcode');

            $('#edit-rowId').val(selectedRowBssId);
            $('#edit-name').val(selectedRowBssName);
            $('#edit-address').val(selectedRowAddress);
            $('#edit-city').val(selectedRowCity);
            $('#edit-province').val(selectedRowProvince);
            $('#edit-longitude').val(selectedRowLongitude);
            $('#edit-latitude').val(selectedRowLatitude);
            $('#edit-slot').val(selectedRowSlot);
            $('#edit-status').val(selectedRowStatus);
            $('#edit-lastping').val(selectedRowLastping);
            $('#edit-created').val(selectedRowCreated);
            $('#edit-updated').val(selectedRowUpdated);
            $('#edit-useractive').val(selectedRowUserActive);
            $('#edit-transactionid').val(selectedRowTransactionId);
            $('#edit-qrcode').val(selectedRowQrCode);

            // Show the edit form
            $('#editForm').show();
            $('#lockerTable').hide();
         });

      });
   </script>

   <script>
      $('#data-table').on('click', '.locker-button', function () {
         var selectedBssShowName;
         var selectedBssShowId;
         selectedBssShowName = $(this).data('name');
         selectedBssShowId = $(this).data('id');
         $('#editForm').hide();
         $('#lockerTable').show();
         document.getElementById("locker-title").innerHTML = "List Locker BSS: " + selectedBssShowName;
         //alert(selectedRowName)
         var dataTable;

         $("#locker-table").dataTable().fnDestroy();

         $(document).ready(function () {
            dataTable = $('#locker-table').DataTable({
               bAutoWidth: false,
               paging: true, // Enable pagination
               searching: true, // Enable searching
               processing: true, // Show a loading indicator
               //ordering: false,
               //order: [[15, 'desc']],
               ajax: {
                  url: '/locker_ajax?bss_id=' + selectedBssShowId, // Replace with your server endpoint
                  type: 'GET', // Use POST or GET as appropriate
                  //dataSrc: 'data', // Specify the property that contains the data in the response
                  dataSrc: function (response) {
                     var role = response.role
                     if (response.data === null) {
                        return [];
                     } else {
                        return response.data;
                     }
                  },
               },
               columns: [ // Define your table columns here
                  { data: 'No' },
                  {
                     // Define the column for the "Delete" button
                     data: null,
                     render: function (data, type, row) {
                        var buttonHTML = '';

                        // Check the "role" value
                        if (dataTable.ajax.json().role === 0 || dataTable.ajax.json().role === 1) {
                           buttonHTML += '<button type="button" class="btn btn-sm btn-danger deletelocker-button" data-id="' + row.Id + '" data-name="' + row.Name + '" style="font-size:0.75rem; margin-bottom:1px"><i class="fa fa-trash"></i> Delete</button>';
                        } else {
                           buttonHTML += 'No Action'
                        }
                        return buttonHTML;
                     }
                  },
                  { data: 'Id' },
                  //{ data: 'BssName' },
                  { data: 'Name' },
                  { data: 'LockerNumber' },
                  { data: 'Status' },
                  { data: 'SwappingOut' },
                  { data: 'Soc' },
                  { data: 'Soh' },
                  { data: 'Temp' },
                  { data: 'StayHour' },
                  { data: 'CreatedAt' },
                  { data: 'UpdatedAt' },
               ],

               language: {
                  emptyTable: "No data available in the table"
               },
               dom: 'lBfrtip', // Include the Buttons extension
               buttons: [
                  {
                     extend: 'csv', // Excel button
                     text: 'Export to CSV', // Set custom text
                  }
               ]
            });
         });

         $('#reloadlocker-button').on('click', function () {
            dataTable.ajax.reload();
         });

         // Handle the "Delete" button click in the DataTable
         $('#locker-table').on('click', '.deletelocker-button', function () {
            selectedLockerDeleteId = $(this).data('id'); // Store the row's ID
            selectedLockerDeleteName = $(this).data('name'); // Store the row's Name
            Swal.fire({
               title: 'Delete Record?',
               text: 'Are you sure you want to delete ' + selectedLockerDeleteName + '?',
               icon: 'warning',
               showCancelButton: true,
               confirmButtonColor: '#ff4748',
               cancelButtonColor: '#36a9e2',
               confirmButtonText: 'Yes, delete it!',
               cancelButtonText: 'Cancel'
            }).then((result) => {
               if (result.isConfirmed) {
                  // Send an AJAX request to delete the record
                  $.ajax({
                     url: '/locker_delete', // Replace with the URL for your server-side delete endpoint
                     type: 'POST',
                     data: { id: selectedLockerDeleteId },
                     success: function (response) {
                        if (response.success) {
                           // Reload the DataTable to reflect the deleted record
                           dataTable.ajax.reload();
                           Toastify({
                              text: "Data " + selectedLockerDeleteName + " deleted successfully",
                              duration: 3000, // Duration in milliseconds
                              close: true, // Show close button
                              style: {
                                 background: "linear-gradient(to right, #7ce1b7, #1ed085)",
                              },
                           }).showToast();
                        } else {
                           Toastify({
                              text: response.message,
                              duration: 3000, // Duration in milliseconds
                              close: true, // Show close button
                              style: {
                                 background: "linear-gradient(to right, #d49090, #ff4748)",
                              },
                           }).showToast();
                        }
                     },
                     error: function () {
                        Toastify({
                           text: "Error: An error occurred while deleting the record.",
                           duration: 3000, // Duration in milliseconds
                           close: true, // Show close button
                           style: {
                              background: "linear-gradient(to right, #d49090, #ff4748)",
                           },
                        }).showToast();
                     }
                  });
               }
            });
         });


         $('#addlocker-button').on('click', function () {
            Swal.fire({
               title: 'Add Locker?',
               text: 'Are you sure you want to add locker ' + selectedBssShowName + '?',
               icon: 'warning',
               showCancelButton: true,
               confirmButtonColor: '#36a9e2',
               cancelButtonColor: '#ff4748',
               confirmButtonText: 'Yes, add locker!',
               cancelButtonText: 'Cancel'
            }).then((result) => {
               if (result.isConfirmed) {
                  // Send an AJAX request to delete the record
                  $.ajax({
                     url: '/locker_add', // Replace with the URL for your server-side delete endpoint
                     type: 'POST',
                     data: { id: selectedBssShowId },
                     success: function (response) {
                        if (response.success) {
                           // Reload the DataTable to reflect the deleted record
                           dataTable.ajax.reload();
                           Toastify({
                              text: "Locker " + selectedBssShowName + " added successfully",
                              duration: 3000, // Duration in milliseconds
                              close: true, // Show close button
                              style: {
                                 background: "linear-gradient(to right, #7ce1b7, #1ed085)",
                              },
                           }).showToast();
                        } else {
                           Toastify({
                              text: response.message,
                              duration: 3000, // Duration in milliseconds
                              close: true, // Show close button
                              style: {
                                 background: "linear-gradient(to right, #d49090, #ff4748)",
                              },
                           }).showToast();
                        }
                     },
                     error: function () {
                        Toastify({
                           text: "Error: An error occurred while adding locker.",
                           duration: 3000, // Duration in milliseconds
                           close: true, // Show close button
                           style: {
                              background: "linear-gradient(to right, #d49090, #ff4748)",
                           },
                        }).showToast();
                     }
                  });
               }
            });
         });

      });


   </script>

   <script>
      // add data
      $(document).ready(function () {
         $("#addDataForm").submit(function (e) {
            e.preventDefault(); // Prevent the form from submitting in the default way

            // Serialize the form data
            var formData = $(this).serialize();

            // Send an AJAX request to the server
            $.ajax({
               type: "POST",
               url: "/bss_add", // Change this to the actual server endpoint
               data: formData,
               success: function (response) {
                  // Handle the success response
                  if (response.success) {
                     // Data added successfully
                     Toastify({
                        text: "Data added successfully",
                        duration: 3000, // Duration in milliseconds
                        close: true, // Show close button
                        style: {
                           background: "linear-gradient(to right, #7ce1b7, #1ed085)",
                        },
                     }).showToast();
                     $('#addBssModal').modal('hide'); // Close the modal
                     dataTable.ajax.reload(); // Load the table
                  } else {
                     // Handle any server-side validation errors
                     Toastify({
                        text: "Error: " + response.message,
                        duration: 3000, // Duration in milliseconds
                        close: true, // Show close button
                        style: {
                           background: "linear-gradient(to right, #d49090, #ff4748)",
                        },
                     }).showToast();
                     //alert("Error: " + response.message);
                  }
               },
               error: function (xhr, status, error) {
                  console.log(xhr.responseText); // Log the response for debugging
                  Toastify({
                     text: "Error: An error occurred while adding data.",
                     duration: 3000, // Duration in milliseconds
                     close: true, // Show close button
                     style: {
                        background: "linear-gradient(to right, #d49090, #ff4748)",
                     },
                  }).showToast();
                  //alert("Error: An error occurred while adding data.");
               },
            });
         });
      });
   </script>

   <script>
      // edit
      $(document).ready(function () {
         $("#editDataForm").submit(function (e) {
            e.preventDefault(); // Prevent the form from submitting in the default way

            // Serialize the form data
            var formData = $(this).serialize();

            // Send an AJAX request to the server
            $.ajax({
               type: "PUT",
               url: "/bss_edit", // Change this to the actual server endpoint
               data: formData,
               success: function (response) {
                  // Handle the success response
                  if (response.success) {
                     // Data added successfully
                     Toastify({
                        text: "Data updated successfully",
                        duration: 3000, // Duration in milliseconds
                        close: true, // Show close button
                        style: {
                           background: "linear-gradient(to right, #7ce1b7, #1ed085)",
                        },
                     }).showToast();
                     $('#addBssModal').modal('hide'); // Close the modal
                     dataTable.ajax.reload(); // Load the table
                     //$('#editForm').hide();
                  } else {
                     // Handle any server-side validation errors
                     Toastify({
                        text: "Error: " + response.message,
                        duration: 3000, // Duration in milliseconds
                        close: true, // Show close button
                        style: {
                           background: "linear-gradient(to right, #d49090, #ff4748)",
                        },
                     }).showToast();
                     $('#editForm').hide();
                     //alert("Error: " + response.message);
                     console.log(formData)
                  }
               },
               error: function (xhr, status, error) {
                  console.log(xhr.responseText); // Log the response for debugging
                  Toastify({
                     text: "Error: An error occurred while updating data.",
                     duration: 3000, // Duration in milliseconds
                     close: true, // Show close button
                     style: {
                        background: "linear-gradient(to right, #d49090, #ff4748)",
                     },
                  }).showToast();
                  $('#editForm').hide();
                  //alert("Error: An error occurred while adding data.");
               },
            });
         });
      });
   </script>





</body>

</html>